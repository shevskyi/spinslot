# 📊 Схема потоку гри (Game Flow Diagram)

## 1️⃣ ПОТОЧНА ПОСЛІДОВНІСТЬ СТАНІВ

```
┌─────────────────────────────────────────────────────────────┐
│                      GATES OF OLYMPUS                        │
│                    Поточний ігровий цикл                     │
└─────────────────────────────────────────────────────────────┘

                            START
                              ↓
                    ┌──────────────────┐
                    │    WELCOME       │
                    │  (random grid)   │
                    │   NO WINNING     │
                    └────────┬─────────┘
                             │ SPIN
                             ↓
                    ┌──────────────────┐
                    │     WIN1         │
                    │   Small Win!     │
                    │   3 символи ◇◇◇ │
                    │   +$ винагорода  │
                    └────────┬─────────┘
                             │ SPIN
                             ↓
                    ┌──────────────────┐
                    │     WIN2         │
                    │  Medium Win!     │
                    │ 6 символів ◇◇◇   │
                    │   ◇◇◇ 2×3 блок   │
                    │  ++ винагорода   │
                    └────────┬─────────┘
                             │ SPIN
                             ↓
                    ┌──────────────────┐
                    │     FAKE         │
                    │   Big Win!       │
                    │ 9 символів ◇◇◇   │
                    │   ◇◇◇ 3×3 блок   │
                    │ +++ винагорода   │
                    └────────┬─────────┘
                             │ SPIN
                             ↓
                    ┌──────────────────┐
                    │     LOSS         │
                    │   Try Again      │
                    │  (no winning)    │
                    │  -2% від total   │
                    └────────┬─────────┘
                             │ SPIN (DESTINY!)
                             ↓
                    ┌──────────────────┐
                    │     MEGA         │
                    │  MEGA WIN! 🎉    │
                    │ 14 символів ★★★  │
                    │   FULL EFFECTS   │
                    │ ++++ винагорода  │
                    └────────┬─────────┘
                             │ COLLECT
                             ↓
                    ┌──────────────────┐
                    │      CTA         │
                    │  COLLECT BONUS   │
                    │   или PLAY NOW   │
                    │   (Link action)  │
                    └────────┬─────────┘
                             │ CONTINUE
                             ↓
                    ┌──────────────────┐
                    │    WELCOME       │
                    │   (new cycle)    │
                    └──────────────────┘
                             ↑
                             │
                    ┌────────┴────────┐
                    │   ЦИКЛ ПОВТОРА  │
                    └─────────────────┘
```

---

## 2️⃣ СИСТЕМА ВИЗНАЧЕННЯ ВИГРЕШУ

```
┌─────────────────────────────────────────────┐
│   НАТИСК SPIN → ВИТЯГ КОНФІГА              │
└──────────────────┬──────────────────────────┘
                   ↓
         ┌─────────────────────┐
         │  gameStates[state]  │
         │  .winPositions      │
         └──────────┬──────────┘
                    ↓
         ┌──────────────────────────┐
         │ calculateWinLevel(array) │
         │ array.length → TYPE      │
         └──────────┬───────────────┘
                    ↓
         ┌──────────────────────────────────┐
         │  Лічильник вигрішних символів:  │
         └──────────────────────────────────┘
                    │
        ┌───┬───┬───┼───┬───┬───┬───┐
        ↓   ↓   ↓   ↓   ↓   ↓   ↓   ↓
       0-2 3  4  5  6  7  8  9-13 14+
        │   │  │  │  │  │  │  │   │
       ❌ ✅ ✅ ✅ ✅ ✅ ✅ ✅ ✅  ✅
       NO  SMALL   MEDIUM   BIG   MEGA
       
       NONE            SMALL          MEDIUM      BIG     MEGA
       
       Програш    3-5 символів  6-8 символів  9-13    14+
       
       "-2%"      "Small Win!"   "Med Win!"    "Big!"   "MEGA WIN 🎉"
```

---

## 3️⃣ КООРДИНАТНА СИСТЕМА ВИГРЕШУ

```
┌────────────────────────────────────────────────┐
│   БАРАБАННА СІТКА: 5 РЯДКІВ × 6 КОЛОН        │
└────────────────────────────────────────────────┘

     КОЛОНА (x)
     0    1    2    3    4    5
   ┌────────────────────────────────┐
 0 │ [0,0][1,0][2,0][3,0][4,0][5,0] │
   │      ▲    ▲    ▲                │
 1 │ [0,1][1,1][2,1][3,1][4,1][5,1] │
   │      ▲    ▲    ▲                │
 2 │ [0,2][1,2][2,2][3,2][4,2][5,2] │ ← y = РЯД
   │      ▲    ▲    ▲                │
 3 │ [0,3][1,3][2,3][3,3][4,3][5,3] │
   │      ▲    ▲    ▲                │
 4 │ [0,4][1,4][2,4][3,4][4,4][5,4] │
   └────────────────────────────────┘
      ↑    ↑    ↑
      │    │    └─ КОЛОНА 2
      │    └────── КОЛОНА 1
      └───────── КОЛОНА 0

┌──────────────────────────────────────────┐
│   ПРИКЛАД ВИГРЕШУ: 3×3 БЛОК (Big Win)  │
└──────────────────────────────────────────┘

     0    1    2    3    4    5
   ┌────────────────────────────────┐
 0 │ [##][##][##][ ][ ][ ] │  ← winPositions включає:
   │                         │     [0,0], [1,0], [2,0],
 1 │ [##][##][##][ ][ ][ ] │     [0,1], [1,1], [2,1],
   │                         │     [0,2], [1,2], [2,2]
 2 │ [##][##][##][ ][ ][ ] │     = 9 символів = BIG WIN
   │                         │
 3 │ [ ][ ][ ][ ][ ][ ] │
   │                         │
 4 │ [ ][ ][ ][ ][ ][ ] │
   └────────────────────────────────┘
```

---

## 4️⃣ ОБРОБКА ВИГРЕШУ В HTML/JS

```
┌────────────────────────────────────┐
│   КОРИСТУВАЧ НАТИСКАЄ SPIN         │
└─────────────────┬──────────────────┘
                  ↓
        ┌─────────────────────┐
        │ onClick Handler     │
        │ playSound('click')  │
        │ nextSpin()          │
        └──────────┬──────────┘
                   ↓
        ┌──────────────────────────┐
        │ const stateData =        │
        │ gameStates[currentState] │
        └──────────┬───────────────┘
                   ↓
        ┌──────────────────────────────┐
        │ spinReels(grid, winPositions)│
        │ (анімація спіння)             │
        └──────────┬───────────────────┘
                   ↓
    ┌──────────────────────────────────────┐
    │ Для кожної координати в winPositions:│
    │ 1. Знайти символ на гріді            │
    │ 2. Додати клас .winning              │
    │ 3. Додати прикраси (border, box-shadow)
    └──────────┬──────────────────────────┘
               ↓
    ┌────────────────────────────────────┐
    │ showWinningAnimations()             │
    │ 1. Обчислити рівень winLevel()      │
    │ 2. Запустити ефекти (спарки, exp.) │
    │ 3. Грати звук                       │
    │ 4. Додати класи .small-win/.big-win │
    └──────────┬─────────────────────────┘
               ↓
    ┌────────────────────────────────────┐
    │ currentState = stateData.next       │
    │ updateUI(currentState)              │
    │ (показати наступний стан)           │
    └────────────────────────────────────┘
```

---

## 5️⃣ ТИПИ ЕФЕКТІВ ПО РІВНЮ ВИГРЕШУ

```
    SMALL WIN                MEDIUM WIN              BIG WIN
    (3-5 symb)              (6-8 symb)             (9-13 symb)
        │                        │                       │
        ↓                        ↓                       ↓
    ✨ Пульс                ✨✨ Більший пульс       ✨✨✨ Вибух
    🔊 Звук                 🔊🔊 Гучніший звук      🔊🔊🔊 Забиває
    🟡 Золотий бордер      🟡🟡 Двійний бордер     🟡🟡🟡 Потрійний
    
    vs
    
    MEGA WIN (14+ symb)
    🎉🎉🎉 ПОВНА ВЕЧІРКА
    ⚡⚡⚡ Молнія
    💥💥💥 Конфеті
    👹 Зевс СВЯТКУЄ
    🔊🔊🔊 ГРОМ!
    📊 +++ винагорода
```

---

## 6️⃣ ЗМІНА ПОСЛІДОВНОСТІ (Модифікація)

### Приклад 1: Безпосередньо до Mega

```
ПОТОЧНО:
welcome → win1 → win2 → fake → loss → mega

ЗМІНЕНО (в config.json):
"win1": {
  ...
  "next": "mega"  ← Змінено з "win2"
}

НОВИЙ ПОТІК:
welcome → win1 ← MEGA!
                 ↓
              mega → cta → welcome
```

### Приклад 2: Без програшу

```
ПОТОЧНО:
... → fake → loss → mega → ...

ЗМІНЕНО:
"fake": {
  ...
  "next": "mega"  ← Змінено з "loss"
}

НОВИЙ ПОТІК:
... → fake ← ПРОПУСТИТИ LOSS
           ↓
        mega → cta → ...
```

### Приклад 3: Нескінченна гаряча полоска

```
НОВИЙ СТАН ДОДАНО:
"hot_streak": {
  "grid": [всі "hv4"],
  "winPositions": [всі позиції],
  "next": "hot_streak"  ← ЦИКЛ НА СОБІ!
}

ПОТІК:
... → fake
        ↓
     hot_streak → hot_streak → hot_streak → ...
     (нескінченно)
```

---

## 7️⃣ МАТРИЦЯ ПЕРЕХОДІВ (State Transition Matrix)

```
ЖЕН ПОТОЧНИХ СОСТОЯНИЙ →

        W    W1   W2   F    L    M    C
        │    │    │    │    │    │    │
        │    │    │    │    │    │    │
W       │ ─→ W1   │    │    │    │    │
W1      │    ─→ W2   │    │    │    │
W2      │        ─→ F    │    │    │
F       │            ─→ L    │    │
L       │                ─→ M    │
M       │                    ─→ C
C       │ ←─ ─ ─ ─ ─ ─ ─ ─ ─

W = welcome
W1 = win1
W2 = win2
F = fake
L = loss
M = mega
C = cta

ЛІНІЙ = напрямок переходу через "next"
```

---

## 8️⃣ ВЗАЄМОДІЯ КОМПОНЕНТІВ

```
┌─────────────────────────────────────────────────────┐
│              SPIN-CONFIG.JSON                       │
│  (конфіг всіх станів, гридів, winPositions)        │
└────────────────────────┬────────────────────────────┘
                         │ читається
                         ↓
┌─────────────────────────────────────────────────────┐
│         CLEAN.HTML (JAVASCRIPT)                     │
│  ┌──────────────────────────────────────────────┐   │
│  │ gameStates[currentState]                    │   │
│  │ ↓                                            │   │
│  │ spinReels(grid, winPositions)                │   │
│  │ ↓                                            │   │
│  │ showWinningAnimations()                      │   │
│  │ ↓                                            │   │
│  │ currentState = next                          │   │
│  │ (цикл)                                       │   │
│  └──────────────────────────────────────────────┘   │
└────────────────────────┬────────────────────────────┘
                         │ використовує
        ┌────────────────┼────────────────┐
        ↓                ↓                ↓
   ┌─────────┐    ┌──────────┐    ┌────────────┐
   │   CSS   │    │  ЗВУКИ   │    │ ЗОБРАЖЕННЯ │
   │(анімація)   │(audio)   │    │(PNG, GIF)  │
   └─────────┘    └──────────┘    └────────────┘
```

---

## 9️⃣ РЕАЛЬНІ ДАНІ ЗПРОЕКТУ

### Поточні winPositions

```
"win1" (Small):   [[0,2],[0,3],[0,4]] = 3 symbols
"win2" (Medium):  [[0,1],[0,2],[1,1],[1,2],[2,1],[2,2]] = 6 symbols
"fake" (Big):     [[0,0],[0,1],[0,2],[1,0],[1,1],[1,2],[2,0],[2,1],[2,2]] = 9 symbols
"mega" (Mega):    [[0,0],[0,1],[0,4],[0,5],[1,0],[1,3],[2,2],[2,5],[3,1],[3,2],[3,4],[4,0],[4,1],[4,4]] = 14 symbols
"loss" (None):    [] = 0 symbols
```

### Поточна послідовність

```
[START] welcome → win1 → win2 → fake → loss → mega → cta → [welcome (цикл)]
```

---

## 🔟 РЕЗЮМЕ В ОДНІЙ СХЕМІ

```
┌────────────────────────────────────────────────────────────┐
│                                                            │
│  CONFIG.JSON ────→ HTML JS ────→ SCREEN                  │
│                                                            │
│  grid          grid display    Барабани 6×5              │
│  ↓             ↓               ↓                           │
│  winPositions  calculateWinLevel()  Визначення вигрешу    │
│  ↓             ↓               ↓                           │
│  next          updateUI()      Наступний стан             │
│                ↓               ↓                           │
│                showEffects()   Ефекти + Звуки             │
│                ↓               ↓                           │
│                [ЦИКЛ]          [ЦИКЛ]                     │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

---

## 🎯 КЛЮЧОВІ МОМЕНТИ

✅ **Все визначається в `spin-config.json`**
✅ **`winPositions` - це список координат вигрішних символів**
✅ **Система ДЕТЕРМІНОВАНА (не RNG)**
✅ **Послідовність станів утворює цикл**
✅ **Без `winPositions` = програш, з `winPositions` = вигреш**
✅ **Кількість в `winPositions` визначає ТИП вигрешу**

**Модифікуйте координати → Модифікуйте гру! 🎰**
